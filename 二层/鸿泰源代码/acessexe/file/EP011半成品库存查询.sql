--EP011°ë³ÉÆ·¿â´æ²éÑ¯
SELECT Data0025.MANU_PART_NUMBER,Data0050.CUSTOMER_PART_NUMBER,
       SUM(dbo.Data0490.QTY_ON_HAND) AS qty_pcs,sum(Data0490.pnls_ON_HAND) as PNL ,
      round(sum(Data0490.pnls_ON_HAND/dATA0025.OPT_LOT_SIZE),4) as LOTS,
       round(sum(Data0490.QTY_ON_HAND*DATA0047_2.PARAMETER_VALUE),4) AS SQ,Data0016.LOCATION,
       Data0050.CP_REV,Data0015.ABBR_NAME
FROM dbo.Data0490 
INNER JOIN dbo.Data0015 ON dbo.Data0490.WHSE_PTR = dbo.Data0015.RKEY 
INNER JOIN dbo.Data0016 ON dbo.Data0490.LOC_PTR = dbo.Data0016.RKEY 
INNER JOIN dbo.Data0025 ON dbo.Data0490.MANU_PART_PTR = dbo.Data0025.RKEY 
INNER JOIN dbo.Data0050 ON dbo.Data0025.ANCESTOR_PTR = dbo.Data0050.RKEY 
INNER JOIN dbo.Data0047 DATA0047_2 ON DATA0025.RKEY=DATA0047_2.SOURCE_POINTER 
INNER JOIN dbo.Data0278 Data0278_2 ON DATA0047_2.PARAMETER_PTR=Data0278_2.rkey
WHERE (Data0490.QTY_ON_HAND > 0)  AND (Data0278_2.rkey =4--@P1
)

GROUP BY  Data0050.CUSTOMER_PART_NUMBER,
Data0025.MANU_PART_NUMBER,Data0016.LOCATION,
Data0050.CP_REV,Data0015.ABBR_NAME
order by data0025.manu_part_number
 
 
