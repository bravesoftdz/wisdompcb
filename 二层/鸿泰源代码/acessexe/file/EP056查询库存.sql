SELECT Data0017.INV_PART_NUMBER,data0017.inv_name,
       Data0017.INV_DESCRIPTION,Data0496.GROUP_NAME,
      SUM(dbo.Data0022.QUAN_ON_HAND) AS quan_total,库存里
      round(SUM(Data0022.QUANTITY * Data0022.PRICE / Data0022.EXCHANGE_RATE)金额
       / SUM(Data0022.QUANTITY),4) AS avl_price,单价
      round(SUM(Data0022.QUAN_ON_HAND * Data0022.PRICE / Data0022.EXCHANGE_RATE),3)
       AS amount, 金额
       Data0002.UNIT_CODE, Data0023.ABBR_NAME,
      dbo.data0019.inv_group_name
FROM Data0022 INNER JOIN
      Data0017 ON Data0022.INVENTORY_PTR = Data0017.RKEY INNER JOIN
      Data0496 ON Data0017.GROUP_PTR = Data0496.RKEY INNER JOIN
      Data0015 ON Data0022.WHOUSE_PTR = Data0015.RKEY INNER JOIN
      Data0002 ON
      Data0017.STOCK_UNIT_PTR = Data0002.RKEY INNER JOIN
      Data0023 ON Data0022.SUPPLIER_PTR = Data0023.RKEY INNER JOIN
      data0019 ON Data0496.GROUP_PTR = data0019.rkey LEFT OUTER JOIN
      Data0016 ON Data0022.LOCATION_PTR = Data0016.RKEY
WHERE (Data0022.QUANTITY <> 0) and
      (data0017.rkey=2850)   
GROUP BY Data0017.INV_PART_NUMBER,data0017.inv_name,Data0017.INV_DESCRIPTION,
      Data0496.GROUP_NAME,Data0002.UNIT_CODE,
      Data0023.ABBR_NAME,data0019.inv_group_name
ORDER BY Data0017.inv_part_number,Data0017.INV_description
