object Form1: TForm1
  Left = 379
  Top = 258
  Width = 751
  Height = 600
  Caption = #34917#21345#23457#25209
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  OldCreateOrder = False
  WindowState = wsMaximized
  OnCreate = FormCreate
  OnShow = FormShow
  PixelsPerInch = 96
  TextHeight = 13
  object pnl1: TPanel
    Left = 0
    Top = 0
    Width = 735
    Height = 41
    Align = alTop
    TabOrder = 0
    object BitBtn1: TBitBtn
      Left = 0
      Top = 8
      Width = 75
      Height = 25
      Caption = #36864#20986
      TabOrder = 0
      OnClick = BitBtn1Click
      Glyph.Data = {
        36060000424D3606000000000000360400002800000020000000100000000100
        08000000000000020000710B0000710B00000001000000000000000000003300
        00006600000099000000CC000000FF0000000033000033330000663300009933
        0000CC330000FF33000000660000336600006666000099660000CC660000FF66
        000000990000339900006699000099990000CC990000FF99000000CC000033CC
        000066CC000099CC0000CCCC0000FFCC000000FF000033FF000066FF000099FF
        0000CCFF0000FFFF000000003300330033006600330099003300CC003300FF00
        330000333300333333006633330099333300CC333300FF333300006633003366
        33006666330099663300CC663300FF6633000099330033993300669933009999
        3300CC993300FF99330000CC330033CC330066CC330099CC3300CCCC3300FFCC
        330000FF330033FF330066FF330099FF3300CCFF3300FFFF3300000066003300
        66006600660099006600CC006600FF0066000033660033336600663366009933
        6600CC336600FF33660000666600336666006666660099666600CC666600FF66
        660000996600339966006699660099996600CC996600FF99660000CC660033CC
        660066CC660099CC6600CCCC6600FFCC660000FF660033FF660066FF660099FF
        6600CCFF6600FFFF660000009900330099006600990099009900CC009900FF00
        990000339900333399006633990099339900CC339900FF339900006699003366
        99006666990099669900CC669900FF6699000099990033999900669999009999
        9900CC999900FF99990000CC990033CC990066CC990099CC9900CCCC9900FFCC
        990000FF990033FF990066FF990099FF9900CCFF9900FFFF99000000CC003300
        CC006600CC009900CC00CC00CC00FF00CC000033CC003333CC006633CC009933
        CC00CC33CC00FF33CC000066CC003366CC006666CC009966CC00CC66CC00FF66
        CC000099CC003399CC006699CC009999CC00CC99CC00FF99CC0000CCCC0033CC
        CC0066CCCC0099CCCC00CCCCCC00FFCCCC0000FFCC0033FFCC0066FFCC0099FF
        CC00CCFFCC00FFFFCC000000FF003300FF006600FF009900FF00CC00FF00FF00
        FF000033FF003333FF006633FF009933FF00CC33FF00FF33FF000066FF003366
        FF006666FF009966FF00CC66FF00FF66FF000099FF003399FF006699FF009999
        FF00CC99FF00FF99FF0000CCFF0033CCFF0066CCFF0099CCFF00CCCCFF00FFCC
        FF0000FFFF0033FFFF0066FFFF0099FFFF00CCFFFF00FFFFFF00000080000080
        000000808000800000008000800080800000C0C0C00080808000191919004C4C
        4C00B2B2B200E5E5E5005A1E1E00783C3C0096646400C8969600FFC8C800465F
        82005591B9006EB9D7008CD2E600B4E6F000D8E9EC0099A8AC00646F7100E2EF
        F100C56A31000000000000000000000000000000000000000000000000000000
        0000000000000000000000000000000000000000000000000000EEEEEEEEEEEE
        F1EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEF1EEEEEEEEEEEEEEEEEEEEEEEEF1E3AC
        E3F1EEEEEEEEEEEEEEEEEEEEEEF1EEACE3F1EEEEEEEEEEEEEEEEEEF1E3E28257
        57E2ACE3F1EEEEEEEEEEEEF1EEE2818181E2ACEEF1EEEEEEEEEEE382578282D7
        578181E2E3EEEEEEEEEEEE81818181D7818181E2EEEEEEEEEEEE57828989ADD7
        57797979F1EEEEEEEEEE8181DEDEACD781818181F1EEEEEEEEEE57898989ADD7
        57AAAAA2D7ADEEEEEEEE81DEDEDEACD781DEDE81D7ACEEEEEEEE57898989ADD7
        57AACEA3AD10EEEEEEEE81DEDEDEACD781DEAC81AC81EEEEEEEE5789825EADD7
        57ABCFE21110EEEEEEEE81DE8181ACD781ACACE28181EEEEEEEE578957D7ADD7
        57ABDE101010101010EE81DE56D7ACD781ACDE818181818181EE57898257ADD7
        57EE10101010101010EE81DE8156ACD781E381818181818181EE57898989ADD7
        57EE82101010101010EE81DEDEDEACD781E381818181818181EE57898989ADD7
        57ACF1821110EEEEEEEE81DEDEDEACD781ACF1818181EEEEEEEE57898989ADD7
        57ABEEAB8910EEEEEEEE81DEDEDEACD781ACE3ACDE81EEEEEEEE57828989ADD7
        57ACEEA3EE89EEEEEEEE8181DEDEACD781ACE381EEDEEEEEEEEEEEDE5E8288D7
        57A2A2A2EEEEEEEEEEEEEEDE8181DED781818181EEEEEEEEEEEEEEEEEEAC8257
        57EEEEEEEEEEEEEEEEEEEEEEEEAC818181EEEEEEEEEEEEEEEEEE}
      NumGlyphs = 2
    end
    object btn1: TBitBtn
      Left = 77
      Top = 7
      Width = 75
      Height = 25
      Caption = #21047#26032
      TabOrder = 1
      OnClick = btn1Click
      Glyph.Data = {
        F6000000424DF600000000000000760000002800000010000000100000000100
        04000000000080000000120B0000120B00001000000010000000000000000000
        8000008000000080800080000000800080008080000080808000C0C0C0000000
        FF00C0C0C00000FFFF00FF000000C0C0C000FFFF0000FFFFFF00DADADADADADA
        DADABFBFBDADADADADADDADADBFADADADADAADADAD000DADADADDADAD0FBF0DA
        DADAADAD0F7FBF0DADADDAD0F7F87BF0DADAAD0F7F87BFB70DADD0F7F87BFB78
        80DA000F87BFB78880ADDAD00BFB78880ADAADADA0B7888740ADDADADA088804
        440AADADADA000A04440DADADADADADA0440ADADADADADADA00D}
    end
    object btn3: TBitBtn
      Left = 154
      Top = 7
      Width = 75
      Height = 25
      Caption = #23548#20986
      TabOrder = 2
      OnClick = btn3Click
      Glyph.Data = {
        F6000000424DF600000000000000760000002800000010000000100000000100
        04000000000080000000120B0000120B00001000000010000000000000000000
        8000008000000080800080000000800080008080000080808000C0C0C0000000
        FF0000FF000000FFFF00FF000000FF00FF00FFFF0000FFFFFF00DADADADADADA
        DADAADADADADADADADADDADADADADAD00000000000000006666007777777706E
        EF0AA0E6666606EEF0ADDA0E66606EEF060AADA0E606EEF0000DDADA006EEF0A
        DADAADAD06EEF00DADADDAD06EEF0670DADAAD06EEF0E6670DADD06EEF0A0E66
        70DA0FFFF0ADA0EEEE0D00000ADADA00000AADADADADADADADAD}
    end
  end
  object pnl2: TPanel
    Left = 0
    Top = 525
    Width = 735
    Height = 37
    Align = alBottom
    TabOrder = 1
  end
  object pnl3: TPanel
    Left = 0
    Top = 41
    Width = 735
    Height = 484
    Align = alClient
    TabOrder = 2
    object Panel2: TPanel
      Left = 1
      Top = 443
      Width = 733
      Height = 40
      Align = alBottom
      TabOrder = 0
      object grp1: TGroupBox
        Left = 101
        Top = 1
        Width = 434
        Height = 38
        Align = alClient
        TabOrder = 0
        object CheckBox2: TCheckBox
          Left = 35
          Top = 14
          Width = 97
          Height = 17
          Caption = #34917#21345
          Checked = True
          State = cbChecked
          TabOrder = 0
          OnClick = CheckBox2Click
        end
        object CheckBox3: TCheckBox
          Left = 163
          Top = 14
          Width = 97
          Height = 17
          Caption = #35831#20551
          TabOrder = 1
          OnClick = CheckBox2Click
        end
        object CheckBox4: TCheckBox
          Left = 284
          Top = 14
          Width = 97
          Height = 17
          Caption = #20462#25913#24037#26102
          TabOrder = 2
          OnClick = CheckBox2Click
        end
      end
      object grp3: TGroupBox
        Left = 1
        Top = 1
        Width = 100
        Height = 38
        Align = alLeft
        TabOrder = 1
        DesignSize = (
          100
          38)
        object chk0: TCheckBox
          Left = 14
          Top = 14
          Width = 97
          Height = 17
          Anchors = [akLeft, akBottom]
          Caption = #20840#36873
          TabOrder = 0
          OnClick = chk0Click
        end
      end
      object RadioGroup1: TRadioGroup
        Left = 535
        Top = 1
        Width = 197
        Height = 38
        Align = alRight
        Caption = '-'
        Columns = 3
        ItemIndex = 0
        Items.Strings = (
          #26410#23457#26680
          #24050#23457#26680
          #24050#36864#22238)
        TabOrder = 2
        OnClick = RadioGroup1Click
      end
    end
    object pnl4: TPanel
      Left = 1
      Top = 1
      Width = 733
      Height = 32
      Align = alTop
      TabOrder = 1
      DesignSize = (
        733
        32)
      object lbl5: TLabel
        Left = 463
        Top = 12
        Width = 89
        Height = 13
        Alignment = taRightJustify
        Anchors = [akTop, akRight]
        AutoSize = False
        Caption = #32771#21220#26085#26399#20174
      end
      object lbl6: TLabel
        Left = 639
        Top = 12
        Width = 12
        Height = 13
        Anchors = [akTop, akRight]
        Caption = #21040
      end
      object lbl1: TLabel
        Left = 16
        Top = 12
        Width = 97
        Height = 13
        AutoSize = False
      end
      object lbl2: TLabel
        Left = 256
        Top = 11
        Width = 57
        Height = 13
        AutoSize = False
        Caption = '0'
      end
      object Label1: TLabel
        Left = 11
        Top = 13
        Width = 113
        Height = 13
        Alignment = taRightJustify
        AutoSize = False
      end
      object dtp1: TDateTimePicker
        Left = 555
        Top = 8
        Width = 80
        Height = 21
        Anchors = [akTop, akRight]
        Date = 41434.000000000000000000
        Format = 'yyyy-MM-dd'
        Time = 41434.000000000000000000
        TabOrder = 0
        OnChange = dtp2Change
      end
      object dtp2: TDateTimePicker
        Left = 659
        Top = 8
        Width = 80
        Height = 21
        Anchors = [akTop, akRight]
        Date = 41434.999305555550000000
        Format = 'yyyy-MM-dd'
        Time = 41434.999305555550000000
        TabOrder = 1
        OnChange = dtp2Change
      end
      object edit1: TEdit
        Left = 128
        Top = 8
        Width = 121
        Height = 21
        TabOrder = 2
        OnChange = edit1Change
      end
    end
    object DBGridEh1: TDBGridEh
      Left = 1
      Top = 33
      Width = 733
      Height = 410
      Align = alClient
      DataSource = dm.ds1
      FooterColor = clWindow
      FooterFont.Charset = DEFAULT_CHARSET
      FooterFont.Color = clWindowText
      FooterFont.Height = -11
      FooterFont.Name = 'MS Sans Serif'
      FooterFont.Style = []
      Options = [dgTitles, dgIndicator, dgColumnResize, dgColLines, dgRowLines, dgTabs, dgRowSelect, dgConfirmDelete, dgCancelOnExit, dgMultiSelect]
      PopupMenu = pm1
      TabOrder = 2
      TitleFont.Charset = DEFAULT_CHARSET
      TitleFont.Color = clWindowText
      TitleFont.Height = -11
      TitleFont.Name = 'MS Sans Serif'
      TitleFont.Style = []
      OnTitleClick = DBGridEh1TitleClick
      Columns = <
        item
          EditButtons = <>
          FieldName = 'selected'
          Footers = <>
          Title.Caption = #36873#20013
        end
        item
          EditButtons = <>
          FieldName = 'departmentname'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #37096#38376#21517#31216
          Width = 100
        end
        item
          EditButtons = <>
          FieldName = 'employeecode'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #24037#21495
          Width = 45
        end
        item
          EditButtons = <>
          FieldName = 'chinesename'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #22995#21517
          Width = 45
        end
        item
          EditButtons = <>
          FieldName = #20107#21153#31867#22411
          Footers = <>
          Width = 80
        end
        item
          EditButtons = <>
          FieldName = #22788#29702#29366#24577
          Footers = <>
          Width = 70
        end
        item
          EditButtons = <>
          FieldName = 'req_starttime'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #35831#20551#24320#22987#26102#38388
          Width = 105
        end
        item
          EditButtons = <>
          FieldName = 'req_endtime'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #35831#20551#32467#26463#26102#38388
          Width = 105
        end
        item
          EditButtons = <>
          FieldName = 'req_cardtime'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #30003#35831#34917#21345
          Width = 150
        end
        item
          EditButtons = <>
          FieldName = 'zbhour'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #30003#35831#27491#29677#23567#26102
          Width = 80
        end
        item
          EditButtons = <>
          FieldName = 'jbhour'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #30003#35831#21152#29677#23567#26102
          Width = 80
        end
        item
          EditButtons = <>
          FieldName = 'askforleaverk'
          Footers = <>
          Title.Alignment = taCenter
          Visible = False
          Width = 0
        end
        item
          EditButtons = <>
          FieldName = 'reqtime'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #25552#20132#25805#20316#26102#38388
        end
        item
          EditButtons = <>
          FieldName = 'reqperson'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #25552#20132#20154
          Width = 50
        end
        item
          EditButtons = <>
          FieldName = 'reqinfo'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #22791#27880
          Width = 100
        end
        item
          EditButtons = <>
          FieldName = 'rkey'
          Footers = <>
          Title.Alignment = taCenter
          Visible = False
          Width = 0
        end
        item
          EditButtons = <>
          FieldName = 'employeeid'
          Footers = <>
          Title.Alignment = taCenter
          Visible = False
          Width = 0
        end
        item
          EditButtons = <>
          FieldName = 'reqstate'
          Footers = <>
          Title.Alignment = taCenter
          Visible = False
          Width = 0
        end
        item
          EditButtons = <>
          FieldName = 'reqtype'
          Footers = <>
          Title.Alignment = taCenter
          Visible = False
          Width = 0
        end
        item
          EditButtons = <>
          FieldName = 'dealperson'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #22788#29702#20154
          Width = 50
        end
        item
          EditButtons = <>
          FieldName = 'dealtime'
          Footers = <>
          Title.Alignment = taCenter
          Title.Caption = #22788#29702#25805#20316#26102#38388
        end>
    end
  end
  object Panel1: TPanel
    Left = 0
    Top = 41
    Width = 0
    Height = 484
    Align = alLeft
    TabOrder = 3
  end
  object pm1: TPopupMenu
    OnPopup = pm1Popup
    Left = 272
    Top = 153
    object N3: TMenuItem
      Caption = '-'
    end
    object N1: TMenuItem
      Caption = #23457#25209#36873#20013#39033
      OnClick = N1Click
    end
    object N9: TMenuItem
      Caption = '-------------------'
    end
    object N8: TMenuItem
      Caption = #21462#28040#23457#25209#36873#20013#39033
      OnClick = N8Click
    end
    object N4: TMenuItem
      Caption = '-'
    end
    object N2: TMenuItem
      Caption = #36864#22238
      OnClick = N2Click
    end
    object N5: TMenuItem
      Caption = '-'
    end
    object N6: TMenuItem
      Caption = #36873#20013
      OnClick = N6Click
    end
    object N7: TMenuItem
      Caption = '-'
    end
    object mniN10: TMenuItem
      Caption = #36229#34917#21345#26597#35810
      OnClick = mniN10Click
    end
  end
  object qry_cancel: TADOQuery
    Connection = dm.ADOConnection1
    Parameters = <
      item
        Name = 'req_rkey'
        Size = -1
        Value = Null
      end
      item
        Name = 'req_type'
        Size = -1
        Value = Null
      end
      item
        Name = 'oper_rkey'
        Size = -1
        Value = Null
      end
      item
        Name = 'oper_name'
        Size = -1
        Value = Null
      end>
    SQL.Strings = (
      ''
      ''
      'declare @req_rkey int'
      'declare @reqtype int'
      'declare @oper_rkey  int'
      'declare @oper_name nvarchar(20)'
      ''
      'set @req_rkey =:req_rkey'
      'set  @reqtype=:req_type'
      'set @oper_rkey=:oper_rkey'
      'set @oper_name=:oper_name'
      ''
      'if @reqtype=0'
      'begin'
      ''
      
        'delete  OriginalCheckData where  employeeid= (select employeeid ' +
        'from req where rkey=@req_rkey and reqtype=@reqtype ) '
      
        'and card_time=(select req_cardtime from req where rkey=@req_rkey' +
        ' and reqtype=@reqtype )  '
      'and remark='#39#25163#24037#34917#21345#39
      ' '
      'end'
      ''
      'if @reqtype=1'
      'begin'
      ''
      
        'delete from   AskLeaveRegister where  employeeID= (select employ' +
        'eeid from req where rkey=@req_rkey and reqtype=@reqtype )  '
      
        'and  starttime= (select req_starttime from req where rkey=@req_r' +
        'key and reqtype=@reqtype ) '
      
        'and endtime=(select req_endtime from req where rkey=@req_rkey an' +
        'd reqtype=@reqtype )'
      ''
      'end'
      ''
      ''
      'if @reqtype=2 '
      'begin'
      ''
      'update onoffdutydata'
      'set rwt=0,'
      'rot=0,'
      'yt=0,ytnote='#39#39','
      'locked=0,ct1=0,ct2=0,ct3=0,kt1=0,'
      'kt2=0,kt3=0,zt1=0,zt2=0,zt3=0,sumct=0, sumzt=0, sumkt=0'
      'from onoffdutydata '
      
        'where checkdate=(select  convert(datetime,convert (nvarchar(20),' +
        ' req_cardtime,23),120) from req where reqtype=2 and rkey=@req_rk' +
        'ey )'
      
        'and employeeid= (select employeeid from req where rkey=@req_rkey' +
        ' and reqtype=@reqtype ) '
      ''
      'end'
      ''
      
        'update req set reqstate=3,dealperson=@oper_name ,dealtime=getdat' +
        'e()'
      'from req where rkey=@req_rkey'
      '')
    Left = 144
    Top = 201
  end
end
