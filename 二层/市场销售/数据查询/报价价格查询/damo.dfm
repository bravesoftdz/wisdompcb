object DM: TDM
  OldCreateOrder = False
  OnCreate = DataModuleCreate
  Left = 496
  Top = 199
  Height = 355
  Width = 310
  object dsMain: TDataSource
    DataSet = qryMain
    Left = 144
    Top = 81
  end
  object qrytemptable: TADOQuery
    Connection = con1
    Parameters = <>
    SQL.Strings = (
      'if exists(select name from sysobjects where name='#39'temptable#'#39') '
      'drop table temptable#'
      'select tnumber '#25253#20215#21333#21495', qte_date '#25253#20215#26085#26399', '
      'case '
      'when AUDITED_STATUS=0 then '#39#26410#25552#20132#39' '
      'when AUDITED_STATUS=1 then '#39#24453#23457#25209#39
      'when AUDITED_STATUS=2 then '#39#24050#36807#26399#39
      'when AUDITED_STATUS=3 then '#39#24050#23457#25209#39
      'when AUDITED_STATUS=4 then '#39#24050#36864#22238#39
      'end '#25253#20215#21333#29366#24577','
      
        'REF_PART_NO '#26412#21378#32534#21495',CUST_PART_NO '#23458#25143#22411#21495',product_name '#20135#21697#31867#22411',cust_name '#23458 +
        #25143#21517#31216',data0010.cust_code '#23458#25143#20195#30721','
      
        'MATL_COST '#26448#26009#25104#26412', ovhd_cost '#24037#33402#25104#26412', base_pcscost '#22522#20215#25104#26412', total_cost '#24635#25104 +
        #26412',  adder_name '#24037#33402#21517#31216',amount '#37329#39069','
      'data0085.ttype,data0085.qte_date, USHEET '#27599#24179#31859#24320#22823#26009'PCS'#25968','
      
        'data0085.rate_margin '#27611#21033#29575', TUSAGE '#22823#26009#21033#29992#29575',CUST_QTE_FACTOR '#39069#22806#21152#20215#29575', CR' +
        'P_EST_QUANTITY '#39069#22806#21152#20215#37329#39069','
      
        ' CURR_RATE '#27719#29575', vatax '#31246#29575',quote_price '#19981#21547#31246#26368#21518#21407#24065#25253#20215', QTE_UNITS '#26368#21518#26412#20301#24065#25253#20215 +
        'RMB,data0001.curr_name '#36135#24065#21517#31216','
      
        ' case when data0085.TUNITS>0 then data0085.UNIT_LEN*data0085.UNI' +
        'T_WTH*0.001*0.001/data0085.TUNITS else 1 end as '#21333#21482#38754#31215
      'into temptable#'
      'from  data0085 '
      'inner join data0432 on data0085.rkey=data0432.qte_ptr'
      'inner join data0348 on data0348.rkey=data0432.source_ptr'
      'inner join data0008 on data0008.rkey=data0085.PROD_CODE_PTR'
      'left join data0010 on data0010.rkey=data0085.cust_ptr'
      'inner join data0001 on data0001.rkey=data0085.curr_ptr'
      
        'where qte_date>= convert(varchar(100),getdate()-3,23) and qte_da' +
        'te<=convert(varchar(100),getdate(),23) and data0085.ttype=0  ')
    Left = 96
    Top = 137
  end
  object qryMain: TADOQuery
    Connection = con1
    CursorType = ctStatic
    Filtered = True
    Parameters = <>
    SQL.Strings = (
      
        'declare @sql nvarchar(4000) '#13'select @sql='#39'select '#25253#20215#21333#21495','#25253#20215#26085#26399','#25253#20215#21333#29366#24577 +
        ','#26412#21378#32534#21495','#23458#25143#22411#21495','#20135#21697#31867#22411','#23458#25143#20195#30721','#23458#25143#21517#31216','#39#13'select @sql =@sql +'#39'sum((case '#24037#33402#21517#31216' w' +
        'hen'#39#39#39' + '#24037#33402#21517#31216' +'#13' '#39#39#39'then  '#37329#39069'  end)) as '#39#39#39'+'#24037#33402#21517#31216'+'#39#39#39','#39
      
        'from (select '#24037#33402#21517#31216' from  temptable#   group by '#24037#33402#21517#31216' ) as a'#13' selec' +
        't @sql=left(@sql,Len(@sql)-1)+'#39' ,'
      #26448#26009#25104#26412', '#22522#20215#25104#26412', '#24037#33402#25104#26412', '#24635#25104#26412', '#39069#22806#21152#20215#37329#39069', '#26368#21518#26412#20301#24065#25253#20215'RMB, '#19981#21547#31246#26368#21518#21407#24065#25253#20215','
      #27599#24179#31859#24320#22823#26009'PCS'#25968', '#27611#21033#29575', '#22823#26009#21033#29992#29575', '#39069#22806#21152#20215#29575', '#27719#29575', '#31246#29575', '#36135#24065#21517#31216','#21333#21482#38754#31215
      
        'from  temptable# where  ttype=0 and qte_date>= convert(varchar(1' +
        '00),getdate()-3,23) and qte_date<=convert(varchar(100),getdate()' +
        ',23)'
      'group by  '#25253#20215#21333#21495','#25253#20215#26085#26399','#25253#20215#21333#29366#24577','#26412#21378#32534#21495','#23458#25143#22411#21495','#20135#21697#31867#22411','#23458#25143#21517#31216','#26448#26009#25104#26412','#24037#33402#25104#26412','
      #22522#20215#25104#26412','#24635#25104#26412','#23458#25143#20195#30721','#26368#21518#26412#20301#24065#25253#20215'RMB,'#27599#24179#31859#24320#22823#26009'PCS'#25968','#27611#21033#29575','#22823#26009#21033#29992#29575','#39069#22806#21152#20215#29575','
      #39069#22806#21152#20215#37329#39069','#27719#29575','#31246#29575','#19981#21547#31246#26368#21518#21407#24065#25253#20215','#36135#24065#21517#31216','#21333#21482#38754#31215#39
      #13'exec (@sql)')
    Left = 96
    Top = 81
  end
  object con1: TADOConnection
    LoginPrompt = False
    Provider = 'SQLOLEDB.1'
    Left = 56
    Top = 81
  end
  object qry1: TADOQuery
    Connection = con1
    Parameters = <>
    SQL.Strings = (
      
        'declare @sql nvarchar(4000) '#13'select @sql='#39'select  '#25253#20215#21333#21495','#25253#20215#26085#26399','#25253#20215#21333#29366 +
        #24577','#26412#21378#32534#21495','#23458#25143#22411#21495','#20135#21697#31867#22411','#23458#25143#20195#30721','#23458#25143#21517#31216','#39
      
        'select @sql =@sql +'#39'sum((case '#24037#33402#21517#31216' when'#39#39#39' + '#24037#33402#21517#31216' +'#13' '#39#39#39'then  '#37329#39069 +
        ' /'#21333#21482#38754#31215'  end)) as '#39#39#39'+'#24037#33402#21517#31216' +'#39#39#39', '#39
      
        'from (select '#24037#33402#21517#31216' from  temptable#   group by '#24037#33402#21517#31216' ) as a '#13'selec' +
        't @sql=left(@sql,Len(@sql)-1)'
      '+'#39' ,('#26448#26009#25104#26412' /'#21333#21482#38754#31215') as '#26448#26009#25104#26412','
      '('#22522#20215#25104#26412' /'#21333#21482#38754#31215') as '#22522#20215#25104#26412','
      '('#24037#33402#25104#26412' /'#21333#21482#38754#31215') as '#24037#33402#25104#26412','
      '('#24635#25104#26412' /'#21333#21482#38754#31215') as '#24635#25104#26412','
      '('#39069#22806#21152#20215#37329#39069' /'#21333#21482#38754#31215') as '#39069#22806#21152#20215#37329#39069','
      '('#26368#21518#26412#20301#24065#25253#20215'RMB /'#21333#21482#38754#31215') as '#26368#21518#26412#20301#24065#25253#20215'RMB,'
      '('#19981#21547#31246#26368#21518#21407#24065#25253#20215'/'#21333#21482#38754#31215') as '#19981#21547#31246#26368#21518#21407#24065#25253#20215','
      #27599#24179#31859#24320#22823#26009'PCS'#25968', '#27611#21033#29575', '#22823#26009#21033#29992#29575', '#39069#22806#21152#20215#29575', '#27719#29575', '#31246#29575', '#36135#24065#21517#31216','#21333#21482#38754#31215
      
        'from  temptable# where  ttype=0 and qte_date>= convert(varchar(1' +
        '00),getdate()-3,23) and qte_date<=convert(varchar(100),getdate()' +
        ',23)'
      
        'group by  '#25253#20215#21333#21495','#25253#20215#26085#26399','#25253#20215#21333#29366#24577','#26412#21378#32534#21495','#23458#25143#22411#21495','#20135#21697#31867#22411','#23458#25143#21517#31216','#26448#26009#25104#26412','#24037#33402#25104#26412','#22522#20215#25104#26412','#24635#25104#26412 +
        ','#23458#25143#20195#30721','#26368#21518#26412#20301#24065#25253#20215'RMB,'
      #27599#24179#31859#24320#22823#26009'PCS'#25968','#27611#21033#29575','#27719#29575','#31246#29575','#36135#24065#21517#31216','#22823#26009#21033#29992#29575','#39069#22806#21152#20215#29575','#39069#22806#21152#20215#37329#39069','#19981#21547#31246#26368#21518#21407#24065#25253#20215','#21333#21482#38754#31215#39
      ''
      'exec (@sql)')
    Left = 96
    Top = 208
  end
end
